{"remainingRequest":"D:\\manage-sys\\front-server-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\manage-sys\\front-server-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\manage-sys\\front-server-admin\\src\\permission.js","dependencies":[{"path":"D:\\manage-sys\\front-server-admin\\src\\permission.js","mtime":1727833454218},{"path":"D:\\manage-sys\\front-server-admin\\babel.config.js","mtime":1727833454164},{"path":"D:\\manage-sys\\front-server-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\manage-sys\\front-server-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\manage-sys\\front-server-admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRDovbWFuYWdlLXN5cy9mcm9udC1zZXJ2ZXItYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlZ2VuZXJhdG9yUnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJEOi9tYW5hZ2Utc3lzL2Zyb250LXNlcnZlci1hZG1pbi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgcm91dGVyIGZyb20gJy4vcm91dGVyJzsKaW1wb3J0IHN0b3JlIGZyb20gJy4vc3RvcmUnOwppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAnZWxlbWVudC11aSc7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsgLy8gcHJvZ3Jlc3MgYmFyCmltcG9ydCAnbnByb2dyZXNzL25wcm9ncmVzcy5jc3MnOyAvLyBwcm9ncmVzcyBiYXIgc3R5bGUKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOyAvLyBnZXQgdG9rZW4gZnJvbSBjb29raWUKaW1wb3J0IGdldFBhZ2VUaXRsZSBmcm9tICdAL3V0aWxzL2dldC1wYWdlLXRpdGxlJzsKTlByb2dyZXNzLmNvbmZpZ3VyZSh7CiAgc2hvd1NwaW5uZXI6IGZhbHNlCn0pOyAvLyBOUHJvZ3Jlc3MgQ29uZmlndXJhdGlvbgoKdmFyIHdoaXRlTGlzdCA9IFsnL2xvZ2luJywgJy9wcm9kdWN0L3BvaU1hbmFnZScsICcvcHJvZHVjdC9hZGRBbmRFZGl0UHJvZHVjdCddOyAvLyBubyByZWRpcmVjdCB3aGl0ZWxpc3QKCnJvdXRlci5iZWZvcmVFYWNoKC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGhhc1Rva2VuLCBoYXNHZXRVc2VySW5mbzsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIC8vIHN0YXJ0IHByb2dyZXNzIGJhcgogICAgICAgICAgTlByb2dyZXNzLnN0YXJ0KCk7CgogICAgICAgICAgLy8gc2V0IHBhZ2UgdGl0bGUKICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZ2V0UGFnZVRpdGxlKHRvLm1ldGEudGl0bGUpOwogICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgIG5leHQoKTsKICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwogICAgICAgIGNhc2UgMTI6CiAgICAgICAgICBoYXNHZXRVc2VySW5mbyA9IHN0b3JlLmdldHRlcnMubmFtZTsKICAgICAgICAgIGlmICghaGFzR2V0VXNlckluZm8pIHsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE3OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIG5leHQoKTsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMTc6CiAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTc7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjA7CiAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3VzZXIvZ2V0SW5mbycpOwogICAgICAgIGNhc2UgMjA6CiAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzA7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDIzOgogICAgICAgICAgX2NvbnRleHQucHJldiA9IDIzOwogICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxNyk7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjc7CiAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3VzZXIvcmVzZXRUb2tlbicpOwogICAgICAgIGNhc2UgMjc6CiAgICAgICAgICBNZXNzYWdlLmVycm9yKF9jb250ZXh0LnQwIHx8ICdIYXMgRXJyb3InKTsKICAgICAgICAgIG5leHQoIi9sb2dpbj9yZWRpcmVjdD0iLmNvbmNhdCh0by5wYXRoKSk7CiAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgICAgIGNhc2UgMzA6CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzM7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDMyOgogICAgICAgICAgLyogaGFzIG5vIHRva2VuKi8KCiAgICAgICAgICBpZiAod2hpdGVMaXN0LmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICAgICAgICAgIC8vIGluIHRoZSBmcmVlIGxvZ2luIHdoaXRlbGlzdCwgZ28gZGlyZWN0bHkKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gb3RoZXIgcGFnZXMgdGhhdCBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyBhcmUgcmVkaXJlY3RlZCB0byB0aGUgbG9naW4gcGFnZS4KICAgICAgICAgICAgbmV4dCgiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpKTsKICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgIH0KICAgICAgICBjYXNlIDMzOgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICB9CiAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzE3LCAyM11dKTsKICB9KSk7CiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsKcm91dGVyLmFmdGVyRWFjaChmdW5jdGlvbiAoKSB7CiAgLy8gZmluaXNoIHByb2dyZXNzIGJhcgogIE5Qcm9ncmVzcy5kb25lKCk7Cn0pOw=="},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","to","from","next","hasToken","hasGetUserInfo","wrap","_callee$","_context","prev","start","document","title","meta","done","abrupt","getters","name","dispatch","t0","error","concat","path","indexOf","stop","_x","_x2","_x3","apply","arguments","afterEach"],"sources":["D:/manage-sys/front-server-admin/src/permission.js"],"sourcesContent":["import router from './router'\r\nimport store from './store'\r\nimport { Message } from 'element-ui'\r\nimport NProgress from 'nprogress' // progress bar\r\nimport 'nprogress/nprogress.css' // progress bar style\r\nimport { getToken } from '@/utils/auth' // get token from cookie\r\nimport getPageTitle from '@/utils/get-page-title'\r\n\r\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\r\n\r\nconst whiteList = ['/login', '/product/poiManage', '/product/addAndEditProduct'] // no redirect whitelist\r\n\r\nrouter.beforeEach(async(to, from, next) => {\r\n  // start progress bar\r\n  NProgress.start()\r\n\r\n  // set page title\r\n  document.title = getPageTitle(to.meta.title)\r\n  NProgress.done()\r\n  next()\r\n  return\r\n  // determine whether the user has logged in\r\n  const hasToken = getToken()\r\n\r\n  if (hasToken) {\r\n    if (to.path === '/login') {\r\n      // if is logged in, redirect to the home page\r\n      next({ path: '/' })\r\n      NProgress.done()\r\n    } else {\r\n      const hasGetUserInfo = store.getters.name\r\n      if (hasGetUserInfo) {\r\n        next()\r\n      } else {\r\n        try {\r\n          // get user info\r\n          await store.dispatch('user/getInfo')\r\n\r\n          next()\r\n        } catch (error) {\r\n          // remove token and go to login page to re-login\r\n          await store.dispatch('user/resetToken')\r\n          Message.error(error || 'Has Error')\r\n          next(`/login?redirect=${to.path}`)\r\n          NProgress.done()\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    /* has no token*/\r\n\r\n    if (whiteList.indexOf(to.path) !== -1) {\r\n      // in the free login whitelist, go directly\r\n      next()\r\n    } else {\r\n      // other pages that do not have permission to access are redirected to the login page.\r\n      next(`/login?redirect=${to.path}`)\r\n      NProgress.done()\r\n    }\r\n  }\r\n})\r\n\r\nrouter.afterEach(() => {\r\n  // finish progress bar\r\n  NProgress.done()\r\n})\r\n"],"mappings":";;;AAAA,OAAOA,MAAM,MAAM,UAAU;AAC7B,OAAOC,KAAK,MAAM,SAAS;AAC3B,SAASC,OAAO,QAAQ,YAAY;AACpC,OAAOC,SAAS,MAAM,WAAW,EAAC;AAClC,OAAO,yBAAyB,EAAC;AACjC,SAASC,QAAQ,QAAQ,cAAc,EAAC;AACxC,OAAOC,YAAY,MAAM,wBAAwB;AAEjDF,SAAS,CAACG,SAAS,CAAC;EAAEC,WAAW,EAAE;AAAM,CAAC,CAAC,EAAC;;AAE5C,IAAMC,SAAS,GAAG,CAAC,QAAQ,EAAE,oBAAoB,EAAE,4BAA4B,CAAC,EAAC;;AAEjFR,MAAM,CAACS,UAAU;EAAA,IAAAC,IAAA,GAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAC,QAAMC,EAAE,EAAEC,IAAI,EAAEC,IAAI;IAAA,IAAAC,QAAA,EAAAC,cAAA;IAAA,OAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAL,IAAA;QAAA;UACpC;UACAd,SAAS,CAACqB,KAAK,CAAC,CAAC;;UAEjB;UACAC,QAAQ,CAACC,KAAK,GAAGrB,YAAY,CAACU,EAAE,CAACY,IAAI,CAACD,KAAK,CAAC;UAC5CvB,SAAS,CAACyB,IAAI,CAAC,CAAC;UAChBX,IAAI,CAAC,CAAC;UAAA,OAAAK,QAAA,CAAAO,MAAA;QAAA;UAWIV,cAAc,GAAGlB,KAAK,CAAC6B,OAAO,CAACC,IAAI;UAAA,KACrCZ,cAAc;YAAAG,QAAA,CAAAL,IAAA;YAAA;UAAA;UAChBA,IAAI,CAAC,CAAC;UAAAK,QAAA,CAAAL,IAAA;UAAA;QAAA;UAAAK,QAAA,CAAAC,IAAA;UAAAD,QAAA,CAAAL,IAAA;UAAA,OAIEhB,KAAK,CAAC+B,QAAQ,CAAC,cAAc,CAAC;QAAA;UAEpCf,IAAI,CAAC,CAAC;UAAAK,QAAA,CAAAL,IAAA;UAAA;QAAA;UAAAK,QAAA,CAAAC,IAAA;UAAAD,QAAA,CAAAW,EAAA,GAAAX,QAAA;UAAAA,QAAA,CAAAL,IAAA;UAAA,OAGAhB,KAAK,CAAC+B,QAAQ,CAAC,iBAAiB,CAAC;QAAA;UACvC9B,OAAO,CAACgC,KAAK,CAACZ,QAAA,CAAAW,EAAA,IAAS,WAAW,CAAC;UACnChB,IAAI,oBAAAkB,MAAA,CAAoBpB,EAAE,CAACqB,IAAI,CAAE,CAAC;UAClCjC,SAAS,CAACyB,IAAI,CAAC,CAAC;QAAA;UAAAN,QAAA,CAAAL,IAAA;UAAA;QAAA;UAKtB;;UAEA,IAAIT,SAAS,CAAC6B,OAAO,CAACtB,EAAE,CAACqB,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;YACrC;YACAnB,IAAI,CAAC,CAAC;UACR,CAAC,MAAM;YACL;YACAA,IAAI,oBAAAkB,MAAA,CAAoBpB,EAAE,CAACqB,IAAI,CAAE,CAAC;YAClCjC,SAAS,CAACyB,IAAI,CAAC,CAAC;UAClB;QAAC;QAAA;UAAA,OAAAN,QAAA,CAAAgB,IAAA;MAAA;IAAA,GAAAxB,OAAA;EAAA,CAEJ;EAAA,iBAAAyB,EAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAA/B,IAAA,CAAAgC,KAAA,OAAAC,SAAA;EAAA;AAAA,IAAC;AAEF3C,MAAM,CAAC4C,SAAS,CAAC,YAAM;EACrB;EACAzC,SAAS,CAACyB,IAAI,CAAC,CAAC;AAClB,CAAC,CAAC","ignoreList":[]}]}